<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP客户维护系统</title>
    <link rel="stylesheet" href="/web/css/bootstrap.css">
    <link rel="stylesheet" href="/web/css/font-awesome.css">
    <link src="/web/css/AdminLTE.min.css">
    <script src="/web/js/jquery-2.2.3.min.js"></script>
    <script src="/web/js/bootstrap.js"></script>
    <style>
        .panel-group{overflow: auto;}
        .leftMenu{margin:10px;margin-top:15px;}
        .leftMenu .panel-heading{font-size:14px;padding-left:20px;height:36px;line-height:36px;color:white;position:relative;cursor:pointer;}/*转成手形图标*/
        .leftMenu .panel-heading span{position:absolute;right:10px;top:12px;}
        .leftMenu .menu-item-left{padding: 2px; background: transparent; border:1px solid transparent;border-radius: 6px;}
        .leftMenu .menu-item-left-selected{background:#A9B5BD;border:1px solid #000000;}
        .leftMenu .menu-item-left:hover{background:#C4E3F3;border:1px solid #1E90FF;}
        .btn-menu{}
        .intro { background-color:red;}
    </style>
</head>
<body>
<nav class="navbar-default" role="navigation" style="background-color: #009688;margin-left: 10px;margin-right: 10px;">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#"><font color="white">VIP客户维护系统</font></a>
        </div>
        <div style="float: right">
            <span id="userName" class="h4 text-danger"></span>
            <button type="button" class="btn navbar-btn" >
                <span id="userIcon" class="glyphicon glyphicon-log-out"></span>
            </button>
        </div>
    </div>
</nav>
<div class="row">
    <div class="col-md-2">
        <div class="panel-group table-responsive" role="tablist" id="menuList">
            <!--<div class="panel panel-primary leftMenu">-->
                <!--&lt;!&ndash; 利用data-target指定要折叠的分组列表 &ndash;&gt;-->
                <!--<div class="panel-heading" id="collapseListGroupHeading0" data-toggle="collapse" role="tab" >-->


                    <!--<h4 class="panel-title btn-menu" data-target="overview.html">-->
                        <!--首页-->
                        <!--&lt;!&ndash;<span class="glyphicon glyphicon-chevron-down right"></span>&ndash;&gt;-->
                    <!--</h4>-->
                <!--</div>-->
            <!--</div>&lt;!&ndash;panel end&ndash;&gt;-->
            <!--<div class="panel panel-primary leftMenu">-->
                <!--&lt;!&ndash; 利用data-target指定要折叠的分组列表 &ndash;&gt;-->
                <!--<div class="panel-heading" id="collapseListGroupHeading1" data-toggle="collapse" data-target="#collapseListGroup1" role="tab" >-->
                    <!--<h4 class="panel-title">-->
                        <!--客户管理-->
                        <!--<span class="glyphicon glyphicon-chevron-right right"></span>-->
                    <!--</h4>-->
                <!--</div>-->
                <!--&lt;!&ndash; .panel-collapse和.collapse标明折叠元素 .in表示要显示出来 &ndash;&gt;-->
                <!--<div id="collapseListGroup1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="collapseListGroupHeading1">-->
                    <!--<ul class="list-group">-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="customer.html">-->
                                <!--客户信息-->
                            <!--</button>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>&lt;!&ndash;panel end&ndash;&gt;-->
            <!--<div class="panel panel-primary leftMenu">-->
                <!--<div class="panel-heading" id="collapseListGroupHeading2" data-toggle="collapse" data-target="#collapseListGroup2" role="tab" >-->
                    <!--<h4 class="panel-title">-->
                        <!--客户分析-->
                        <!--<span class="glyphicon glyphicon-chevron-right right"></span>-->
                    <!--</h4>-->
                <!--</div>-->
                <!--<div id="collapseListGroup2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="collapseListGroupHeading2">-->
                    <!--<ul class="list-group">-->
                        <!--<li class="list-group-item">-->
                            <!--<button class="menu-item-left btn-menu">-->
                                <!--<span class="glyphicon"></span>业绩汇总（等待格式中）-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--<li class="list-group-item">-->
                            <!--<button class="menu-item-left btn-menu" data-target="customerSort.html">-->
                                <!--客户排名-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--<li class="list-group-item">-->
                            <!--<button class="menu-item-left btn-menu" data-target="customerAnalyse.html">-->
                                <!--投资期限偏好分析-->
                            <!--</button>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="panel panel-primary leftMenu">-->
                <!--&lt;!&ndash; 利用data-target指定要折叠的分组列表 &ndash;&gt;-->
                <!--<div class="panel-heading" id="collapseListGroupHeading3" data-toggle="collapse" data-target="#collapseListGroup3" role="tab" >-->
                    <!--<h4 class="panel-title">-->
                        <!--客户提醒-->
                        <!--<span class="glyphicon glyphicon-chevron-right right"></span>-->
                    <!--</h4>-->
                <!--</div>-->
                <!--&lt;!&ndash; .panel-collapse和.collapse标明折叠元素 .in表示要显示出来 &ndash;&gt;-->
                <!--<div id="collapseListGroup3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="collapseListGroupHeading3">-->
                    <!--<ul class="list-group">-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->

                            <!--<button class="menu-item-left btn-menu" data-target="timeWarn.html">-->
                                <!--回款时间提醒-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="moneyReduceWarn.html">-->
                                <!--<span class="glyphicon"></span>投资幅度提醒-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="monthWarn.html">-->
                                <!--<span class="glyphicon"></span>30天未投资提醒-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="birthdayWarn.html">-->
                                <!--<span class="glyphicon"></span>生日提醒-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="earningsPlan.html">-->
                                <!--<span class="glyphicon"></span>回款计划-->
                            <!--</button>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>&lt;!&ndash;panel end&ndash;&gt;-->
            <!--<div class="panel panel-primary leftMenu">-->
                <!--&lt;!&ndash; 利用data-target指定要折叠的分组列表 &ndash;&gt;-->
                <!--<div class="panel-heading" id="collapseListGroupHeading4" data-toggle="collapse" data-target="#collapseListGroup4" role="tab" >-->
                    <!--<h4 class="panel-title">-->
                        <!--短信管理-->
                        <!--<span class="glyphicon glyphicon-chevron-right right"></span>-->
                    <!--</h4>-->
                <!--</div>-->
                <!--&lt;!&ndash; .panel-collapse和.collapse标明折叠元素 .in表示要显示出来 &ndash;&gt;-->
                <!--<div id="collapseListGroup4" class="panel-collapse collapse" role="tabpanel" aria-labelledby="collapseListGroupHeading4">-->
                    <!--<ul class="list-group">-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="birthdaymsg.html">-->
                                <!--<span class="glyphicon"></span>生日自动祝福-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--&lt;!&ndash;<li class="list-group-item">&ndash;&gt;-->
                        <!--&lt;!&ndash;&lt;!&ndash; 利用data-target指定URL &ndash;&gt;&ndash;&gt;-->
                        <!--&lt;!&ndash;<button class="menu-item-left btn-menu" data-target="test2.html">&ndash;&gt;-->
                        <!--&lt;!&ndash;<span class="glyphicon"></span>节假日自动祝福&ndash;&gt;-->
                        <!--&lt;!&ndash;</button>&ndash;&gt;-->
                        <!--&lt;!&ndash;</li>&ndash;&gt;-->
                        <!--&lt;!&ndash;<li class="list-group-item">&ndash;&gt;-->
                        <!--&lt;!&ndash;&lt;!&ndash; 利用data-target指定URL &ndash;&gt;&ndash;&gt;-->
                        <!--&lt;!&ndash;<button class="menu-item-left btn-menu" data-target="test2.html">&ndash;&gt;-->
                        <!--&lt;!&ndash;<span class="glyphicon"></span>短信库管理&ndash;&gt;-->
                        <!--&lt;!&ndash;</button>&ndash;&gt;-->
                        <!--&lt;!&ndash;</li>&ndash;&gt;-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="msghistory.html">-->
                                <!--<span class="glyphicon"></span>发送历史记录-->
                            <!--</button>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>&lt;!&ndash;panel end&ndash;&gt;-->
            <!--<div class="panel panel-primary leftMenu">-->
                <!--&lt;!&ndash; 利用data-target指定要折叠的分组列表 &ndash;&gt;-->
                <!--<div class="panel-heading" id="collapseListGroupHeading5" data-toggle="collapse" data-target="#collapseListGroup5" role="tab" >-->
                    <!--<h4 class="panel-title">-->
                        <!--客户奖励-->
                        <!--<span class="glyphicon glyphicon-chevron-right right"></span>-->
                    <!--</h4>-->
                <!--</div>-->
                <!--&lt;!&ndash; .panel-collapse和.collapse标明折叠元素 .in表示要显示出来 &ndash;&gt;-->
                <!--<div id="collapseListGroup5" class="panel-collapse collapse" role="tabpanel" aria-labelledby="collapseListGroupHeading5">-->
                    <!--<ul class="list-group">-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="customergift.html">-->
                                <!--<span class="glyphicon"></span>客户奖励-->
                            <!--</button>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>&lt;!&ndash;panel end&ndash;&gt;-->
            <!--<div class="panel panel-primary leftMenu">-->
                <!--&lt;!&ndash; 利用data-target指定要折叠的分组列表 &ndash;&gt;-->
                <!--<div class="panel-heading" id="collapseListGroupHeading6" data-toggle="collapse" data-target="#collapseListGroup6" role="tab" >-->
                    <!--<h4 class="panel-title">-->
                        <!--营销记录-->
                        <!--<span class="glyphicon glyphicon-chevron-right right"></span>-->
                    <!--</h4>-->
                <!--</div>-->
                <!--&lt;!&ndash; .panel-collapse和.collapse标明折叠元素 .in表示要显示出来 &ndash;&gt;-->
                <!--<div id="collapseListGroup6" class="panel-collapse collapse" role="tabpanel" aria-labelledby="collapseListGroupHeading6">-->
                    <!--<ul class="list-group">-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="genjinhistory.html">-->
                                <!--<span class="glyphicon"></span>营销记录-->
                            <!--</button>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>&lt;!&ndash;panel end&ndash;&gt;-->
            <!--<div class="panel panel-primary leftMenu">-->
                <!--&lt;!&ndash; 利用data-target指定要折叠的分组列表 &ndash;&gt;-->
                <!--<div class="panel-heading" id="collapseListGroupHeading0" data-toggle="collapse" data-target="#collapseListGroup0" role="tab" >-->
                    <!--<h4 class="panel-title">-->
                        <!--员工管理-->
                        <!--<span class="glyphicon glyphicon-chevron-right right"></span>-->
                    <!--</h4>-->
                <!--</div>-->
                <!--&lt;!&ndash; .panel-collapse和.collapse标明折叠元素 .in表示要显示出来 &ndash;&gt;-->
                <!--<div id="collapseListGroup0" class="panel-collapse collapse" role="tabpanel" aria-labelledby="collapseListGroupHeading0">-->
                    <!--<ul class="list-group">-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="usermanage.html">-->
                                <!--<span class="glyphicon"></span>用户管理-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="rolemanage.html">-->
                                <!--<span class="glyphicon"></span>角色管理-->
                            <!--</button>-->
                        <!--</li>-->
                        <!--<li class="list-group-item">-->
                            <!--&lt;!&ndash; 利用data-target指定URL &ndash;&gt;-->
                            <!--<button class="menu-item-left btn-menu" data-target="powermanage.html">-->
                                <!--<span class="glyphicon"></span>权限管理-->
                            <!--</button>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>-->
        </div>
    </div>
    <div class="col-md-10">
        <!--<iframe id="content" frameborder="0"></iframe>-->
        <div>
            <iframe src="" name="content" frameborder="0" id="content" width="100%" onload="iFrameHeight();">

            </iframe>
        </div>
    </div>
</div>
</body>

<script>
    var lastSelectMenu;
    var initMenu = function () {
        var content = '<div class="panel panel-primary leftMenu">';
        content += '<div class="panel-heading" id="collapseListGroupHeading${titleId}" data-toggle="collapse" role="tab" >';
        content += '    <h4 class="panel-title ${isClick}" ${url}>';
        content += '        ${titleName}';
        content += '        <span class="glyphicon glyphicon-chevron-right right" id="span${titleId}" style="display: none;"></span>';
        content += '    </h4>';
        content += '</div>';
        content += '<div id="collapseListGroup${titleId}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="collapseListGroupHeading${titleId}">';
        content += '    <ul class="list-group" id="ul${titleId}">';
        content += '    </ul>';
        content += '</div>';
        content += '</div>';
        var powerLi = '';
        powerLi += '        <li class="list-group-item">';
        powerLi += '            <button class="menu-item-left btn-menu" data-target="${powerUrl}">';
        powerLi += '                ${powerName}';
        powerLi += '            </button>';
        powerLi += '        </li>';
        if (localStorage.getItem("user") == null) {

            window.location.href="/web/html/login.html";
        }
        var data = JSON.parse(localStorage.getItem("user")).role.permissions;
        $("#userName").html(JSON.parse(localStorage.getItem("user")).login_name);
//        $("#userIcon").attr("class", "")
        for(var i = 0 ; i < data.length; i ++) {
            // var temp = data[i];
            if (data[i].parent_id === 0 || data[i].is_menu === 0) {
                continue;
            }
            if (data[i].parent_id === 1) {
                var titleId = "#collapseListGroupHeading" + data[i].id;
                if ($(titleId).length < 1 ) {
                    console.log("新增一级菜单：" + data[i].name);
                    console.log("test");
                    var tempStr = content;
                    tempStr = tempStr.replace(/\$\{titleId\}/g, data[i].id);
                    tempStr = tempStr.replace(/\$\{titleName\}/g, data[i].name);

                    if (data[i].url != "") {
                        tempStr = tempStr.replace(/\$\{url\}/g, "data-target=" + data[i].url);
                        tempStr = tempStr.replace(/\$\{isClick\}/g, "btn-menu");
                    } else{
                        tempStr = tempStr.replace(/\$\{url\}/g, "");
                        tempStr = tempStr.replace(/\$\{isClick\}/g, "");
                    }
                    $("#menuList").append(tempStr);
                }
            }
            else {
                var ulId = "#ul" + data[i].parent_id;
                var spanId = "#span" + data[i].parent_id;
                var titleId = "#collapseListGroupHeading" + data[i].parent_id;
                var tempStr = powerLi;
                tempStr = tempStr.replace(/\$\{powerUrl\}/g, data[i].url);
                tempStr = tempStr.replace(/\$\{powerName\}/g, data[i].name);
                $(spanId).show();
                $(titleId).attr("data-target", "#collapseListGroup" + data[i].parent_id);
                $(ulId).append(tempStr);
            }
        }
    }
    initMenu();
    function iFrameHeight(){
        var ifm = document.getElementById("content");
        ifm.height = document.documentElement.clientHeight;
    }
    $(document).ready(function() {
        $("#userIcon").click(function () {
            localStorage.removeItem("user");
            window.location.href = "/web/html/login.html";
        });
        $("#menuList").on("click", '.panel-heading', function () {
            $(this).find("span").toggleClass("glyphicon-chevron-right");
            $(this).find("span").toggleClass("glyphicon-chevron-down");
        });
        $("#menuList").on("click", '.inactive', function () {
            if($(this).siblings('ul').css('display')=='none'){
                $(this).parent('li').siblings('li').removeClass('inactives');
                $(this).addClass('inactives');
                $(this).siblings('ul').slideDown(500).children('li');
                if($(this).parents('li').siblings('li').children('ul').css('display')=='block'){
                    $(this).parents('li').siblings('li').children('ul').parent('li').children('a').removeClass('inactives');
                    $(this).parents('li').siblings('li').children('ul').slideUp(500);
                }
            }else{
                //控制自身变成+号
                $(this).removeClass('inactives');
                //控制自身菜单下子菜单隐藏
                $(this).siblings('ul').slideUp(500);
                //控制自身子菜单变成+号
                $(this).siblings('ul').children('li').children('ul').parent('li').children('a').addClass('inactives');
                //控制自身菜单下子菜单隐藏
                $(this).siblings('ul').children('li').children('ul').slideUp(500);

                //控制同级菜单只保持一个是展开的（-号显示）
                $(this).siblings('ul').children('li').children('a').removeClass('inactives');
            }
        });

        function loadPage(param) {
//            window.frames["content"].src = "/web/html/" + param;
            document.getElementById("content").src = "/web/html/" + param;
        }
        $("#menuList").on("click", ".btn-menu", function () {
            var page = $(this).attr("data-target");
            var isFirstPage = ("首页" === this.innerText);
            if (!isFirstPage) {
                $(this).addClass('menu-item-left-selected');
            }
            if (lastSelectMenu) {
                lastSelectMenu.removeClass('menu-item-left-selected');
            }
            if (!isFirstPage) {
                lastSelectMenu = $(this);
            }
            else {
                lastSelectMenu = null;
            }
//        console.log(page);
            loadPage(page);
//            $("#content").load("../html/" + page);
        });
//        $(this).css("intro");


//        $(".menu-item-left").click(function(){
//                $(".menu-item-left").removeClass("intro");
//            });
//
//
//        $(this).on("click", ".btn-menu", function () {
//            $(".intro").removeClass("intro");
//            $(this).addClass("intro");
//           $(this).css("intro");
//        });
        loadPage("overview.html");
    });

</script>
<!--<script src="/web/js/require.js"></script>-->
<!--<script src="/web/js/jquery-2.2.3.min.js"></script>-->
<!--<script>-->
<!--//    var temp;-->
    <!--$(function () {-->
        <!--require(['/web/html/js/index.js'], function (index) {-->
            <!--temp = index;-->
        <!--});-->

    <!--});-->
<!--</script>-->
</html>